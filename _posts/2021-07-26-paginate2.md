---
layout: post
title: Leveraging Jekyll Paginate v2 
published: true
release_date: 2021-07-15
tags: guide 
---

GitHub Pages, the Jekyll website generator used for this site, generally works pretty well. One of the major upsides is simplicity, but like all simplistic coding tools, there are guard rails in place as well. Simplicity comes at a cost. In our case, only [8 jekyll plugins are supported by GH pages](https://docs.github.com/en/pages/setting-up-a-github-pages-site-with-jekyll/about-github-pages-and-jekyll). 

## Summary

The purpose of this guide is to provide a workaround. By building your site using travis-CI, and deploying the built-up webpage to GH from travis, you can bypass GH Pages inability to build a site using unsupported plugins. This workaround took me ~4-6 hours of rather frustrating work, and if you do not absolutely need the workaround I encourage you to not make your life more difficult.

## Problem Statement

The state of the problem is this: running the command `jekyll build` takes the scaffolding that you write, and turns it into a full-fledged website in your _site folder. When you push to your `gh-pages` branch on GitHub, this build process is done in some fashion by GitHub. Since GitHub Pages only supports 8 plugins, if your site leverages an un-supported plugin, GH pages will simply not know how to use the plugin and therefore your site will break! This is not ideal behavior. 

The general idea of the problems is this: instead of having GitHub deal with your build process and fumble your plugin usage, you can use a CI/CD tool like [Travis-CI](https://travis-ci.com/). With a correctly configured Travis-CI deployment, pushing to GitHub triggers a CI job, which runs a script to build your `_site` folder, and then simply copies the contents of your newly built site into the `gh-pages` branch. So, the Travis-CI container builds your site for you, and just drops the now-static webpages into GitHub. 

I'm not in the business of redundancy (or plagiarism for that matter), so I'll start by providing the resources I used, and finish by providing some of my notes and code that helped fill in the gaps. 

## Resources 
1. [High level guide to deploying to gh-pages via Travis CI](https://ayastreb.me/deploy-jekyll-to-github-pages-with-travis-ci/)
    - This guide is very useful for understanding the workflow and setting up a framework to build off of, but is lacking some details. 
2. [This guide by Lou Marven helped me build out my CI/CD script](https://www.loumarven.dev/2020/02/23/getting-a-good-old-jekyll-theme-to-work-on-gitlab-pages/)
    - This guide may not be needed, I used it primarily to fix jekyll-paginate, which I had broken somehow 
3. [Travis CI documentation on Github Pages Deployments](https://docs.travis-ci.com/user/deployment/pages/)


## Filling in the gaps 

After following Resource #1 and reading through the other two resources, your Travis-CI deployment still probably won't work. The two kinds of issues I came across were dependency/bundler issues, and GitHub authentication issues. All in all, it was a great exercise in debugging, but I'm glad to be done. 

### GitHub Authentication 

The above guides don't explain how to give the proper permissions to Travis-CI. At a high level, these are the steps 
1. Generate a github Personal Access Token (PAT) [here](https://github.com/settings/tokens). 
2. Encrypt your PAT using the instructions [here](https://docs.travis-ci.com/user/environment-variables#encrypting-environment-variables). 
    - `travis encrypt github_token="PAT_goes_here_keep_the_parentheses!!!" --add`
3. Define the variable in your Travis Repository settings using the instructions [here](https://docs.travis-ci.com/user/environment-variables#defining-variables-in-repository-settings) 
    - Truthfully I'm not sure if steps #2 and #3 are redundant. The bold can skip step 3 and return later if Auth isn't working. 

After this, GitHub should authenticate properly. If you're running into errors, you can check if Auth is at fault by going to your GitHub PAT page and seeing if GitHub has ever used it. 

### Code snippets 

There are 